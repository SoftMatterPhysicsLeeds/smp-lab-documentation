
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation for the equipment/processes used in the Soft Matter Physics Group at the University of Leeds.">
      
      
        <meta name="author" content="Dan Baker">
      
      
        <link rel="canonical" href="https://softmatterphysicsleeds.github.io/least-squares-fitting/">
      
      
        <link rel="prev" href="../git/">
      
      
        <link rel="next" href="../microscope/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.33">
    
    
      
        <title>Least Squares Fitting - SMP Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.3cba04c6.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#least-squares-fitting" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="SMP Documentation" class="md-header__button md-logo" aria-label="SMP Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.46 6.28 11.05 9c-2.58.26-4.55 2.41-4.55 5a5 5 0 0 0 5 5c2.05 0 3.81-1.23 4.58-3H13.5v-2h8v2h-2.25a8.048 8.048 0 0 1-2.46 4h2.71v2h-16v-2h2.71a7.99 7.99 0 0 1-2.71-6c0-3.63 2.46-6.8 5.96-7.72m3.28-4.21.76 1.3.86-.5 3.5 6.06-3.47 2-3.5-6.06.87-.5-.76-1.3 1.74-1Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            SMP Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Least Squares Fitting
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="custom" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="SMP Documentation" class="md-nav__button md-logo" aria-label="SMP Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.46 6.28 11.05 9c-2.58.26-4.55 2.41-4.55 5a5 5 0 0 0 5 5c2.05 0 3.81-1.23 4.58-3H13.5v-2h8v2h-2.25a8.048 8.048 0 0 1-2.46 4h2.71v2h-16v-2h2.71a7.99 7.99 0 0 1-2.71-6c0-3.63 2.46-6.8 5.96-7.72m3.28-4.21.76 1.3.86-.5 3.5 6.06-3.47 2-3.5-6.06.87-.5-.76-1.3 1.74-1Z"/></svg>

    </a>
    SMP Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../dls/" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 14h-2V9h2m0 9h-2v-2h2M1 21h22L12 2 1 21Z"/></svg>
  
  <span class="md-ellipsis">
    3D PCS
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../anton-paar/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Anton Paar Rheometer
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../booking-system/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Booking System
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../bruker-nmr-diffusion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bruker NMR (Diffusion)
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../dscQ20/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DSC
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../folium-rubbing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Folium Rubbing Machine
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../git/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Git / Github
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Least Squares Fitting
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Least Squares Fitting
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#excel" class="md-nav__link">
    <span class="md-ellipsis">
      Excel
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Excel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#open-the-data" class="md-nav__link">
    <span class="md-ellipsis">
      Open the data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generate-fit-line" class="md-nav__link">
    <span class="md-ellipsis">
      Generate 'fit' line
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#calculate-chi2" class="md-nav__link">
    <span class="md-ellipsis">
      Calculate \(\chi^{2}\)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#load-the-solver" class="md-nav__link">
    <span class="md-ellipsis">
      Load the 'Solver'
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#origin" class="md-nav__link">
    <span class="md-ellipsis">
      Origin
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Origin">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#data-manipulation" class="md-nav__link">
    <span class="md-ellipsis">
      Data Manipulation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#defining-a-new-fit-function" class="md-nav__link">
    <span class="md-ellipsis">
      Defining a new fit function
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fit-the-data" class="md-nav__link">
    <span class="md-ellipsis">
      Fit the data
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#matlab" class="md-nav__link">
    <span class="md-ellipsis">
      Matlab
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Matlab">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#data-manipulation_1" class="md-nav__link">
    <span class="md-ellipsis">
      Data Manipulation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#define-a-fit-function" class="md-nav__link">
    <span class="md-ellipsis">
      Define a fit function
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Define a fit function">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#in-line" class="md-nav__link">
    <span class="md-ellipsis">
      In-Line
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#separate-file" class="md-nav__link">
    <span class="md-ellipsis">
      Separate File
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fit-the-data_1" class="md-nav__link">
    <span class="md-ellipsis">
      Fit the Data
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#python" class="md-nav__link">
    <span class="md-ellipsis">
      Python
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Python">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#import-modules" class="md-nav__link">
    <span class="md-ellipsis">
      Import modules
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-manipulation_2" class="md-nav__link">
    <span class="md-ellipsis">
      Data Manipulation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#define-fit-function" class="md-nav__link">
    <span class="md-ellipsis">
      Define fit function
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fit-the-data_2" class="md-nav__link">
    <span class="md-ellipsis">
      Fit the data
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#julia" class="md-nav__link">
    <span class="md-ellipsis">
      Julia
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Julia">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#load-modules" class="md-nav__link">
    <span class="md-ellipsis">
      Load modules
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-manipulation_3" class="md-nav__link">
    <span class="md-ellipsis">
      Data Manipulation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#define-fit-function_1" class="md-nav__link">
    <span class="md-ellipsis">
      Define fit function
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../microscope/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Microscopy
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../novocontrol-dielectric/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Novocontrol Dielectric Spectrometer
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../raman/" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 14h-2V9h2m0 9h-2v-2h2M1 21h22L12 2 1 21Z"/></svg>
  
  <span class="md-ellipsis">
    Raman
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../stelar-ffc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Stelar FFC NMR
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../universal-analysis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Universal Analysis (DSC analysis)
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../useful-tips/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Useful Tips
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../vacuum-ovens/" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 14h-2V9h2m0 9h-2v-2h2M1 21h22L12 2 1 21Z"/></svg>
  
  <span class="md-ellipsis">
    Vacuum Ovens
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#excel" class="md-nav__link">
    <span class="md-ellipsis">
      Excel
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Excel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#open-the-data" class="md-nav__link">
    <span class="md-ellipsis">
      Open the data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generate-fit-line" class="md-nav__link">
    <span class="md-ellipsis">
      Generate 'fit' line
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#calculate-chi2" class="md-nav__link">
    <span class="md-ellipsis">
      Calculate \(\chi^{2}\)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#load-the-solver" class="md-nav__link">
    <span class="md-ellipsis">
      Load the 'Solver'
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#origin" class="md-nav__link">
    <span class="md-ellipsis">
      Origin
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Origin">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#data-manipulation" class="md-nav__link">
    <span class="md-ellipsis">
      Data Manipulation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#defining-a-new-fit-function" class="md-nav__link">
    <span class="md-ellipsis">
      Defining a new fit function
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fit-the-data" class="md-nav__link">
    <span class="md-ellipsis">
      Fit the data
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#matlab" class="md-nav__link">
    <span class="md-ellipsis">
      Matlab
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Matlab">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#data-manipulation_1" class="md-nav__link">
    <span class="md-ellipsis">
      Data Manipulation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#define-a-fit-function" class="md-nav__link">
    <span class="md-ellipsis">
      Define a fit function
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Define a fit function">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#in-line" class="md-nav__link">
    <span class="md-ellipsis">
      In-Line
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#separate-file" class="md-nav__link">
    <span class="md-ellipsis">
      Separate File
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fit-the-data_1" class="md-nav__link">
    <span class="md-ellipsis">
      Fit the Data
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#python" class="md-nav__link">
    <span class="md-ellipsis">
      Python
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Python">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#import-modules" class="md-nav__link">
    <span class="md-ellipsis">
      Import modules
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-manipulation_2" class="md-nav__link">
    <span class="md-ellipsis">
      Data Manipulation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#define-fit-function" class="md-nav__link">
    <span class="md-ellipsis">
      Define fit function
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fit-the-data_2" class="md-nav__link">
    <span class="md-ellipsis">
      Fit the data
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#julia" class="md-nav__link">
    <span class="md-ellipsis">
      Julia
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Julia">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#load-modules" class="md-nav__link">
    <span class="md-ellipsis">
      Load modules
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-manipulation_3" class="md-nav__link">
    <span class="md-ellipsis">
      Data Manipulation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#define-fit-function_1" class="md-nav__link">
    <span class="md-ellipsis">
      Define fit function
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="least-squares-fitting">Least Squares Fitting</h1>
<p>Author: Dan Baker</p>
<h2 id="introduction">Introduction</h2>
<p>This document will show you how to fit some experimental data with a non-linear function. You can then use these examples to fit your own data by changing the data/function. </p>
<p>The example data are structural relaxation timescales, <span class="arithmatex">\(\tau_\alpha\)</span>,  as a function of temperature. These data can be well described using the Vogel-Fulcher-Tammann (VFT) equation: </p>
<div class="arithmatex">\[\begin{equation}
    \tau_\alpha = \tau_{0}e^{\frac{DT_{0}}{T-T_{0}}}
    \label{eq:VFT}
\end{equation}\]</div>
<p>where <span class="arithmatex">\(\tau_0\)</span> is a typical timescale for molecular motion at high temperature (usually <span class="arithmatex">\(10^{-14} - 10^{-12}\)</span>s), <span class="arithmatex">\(D\)</span> is the 'strength' parameter (analogous to the inverse of fragility), and <span class="arithmatex">\(T_0\)</span> is an 'ideal' glass transition temperature. To prevent the fit routine being biased towards larger values of <span class="arithmatex">\(\tau_\alpha\)</span> (as the functional form is exponential) it is often better to fit the logarithm of this equation to the logarithm of the data. In base 10 (for fun): </p>
<div class="arithmatex">\[\begin{equation}
    \mathrm{log}_{10}\left(\tau_\alpha\right) = \mathrm{log}_{10}\left(\tau_{0}\right) + \frac{\mathrm{log}_{10}\left(e^{1}\right)DT_{0}}{T-T_{0}}
    \label{eq:VFT_logged}
\end{equation}\]</div>
<h2 id="excel">Excel</h2>
<h3 id="open-the-data">Open the data</h3>
<p>Load the data (copy/paste, open .txt file, whatever) into <strong>Excel</strong>:</p>
<figure>
<p><img alt="Excel load data" src="../static/least-squares/Excel%20Images/load_data_excel.PNG" /></p>
</figure>
<h3 id="generate-fit-line">Generate 'fit' line</h3>
<p>Generate data based on the function that you want to fit. In this case, I have generated data based on equation \ref{eq:VFT_logged}, using column B as input for T (so that the generated fit values are of the same length as the experimental <span class="arithmatex">\(\tau_\alpha\)</span> data) and the cells K3, K4 and K5 as the parameters <span class="arithmatex">\(\mathrm{log}_{10}(\tau_0)\)</span>, <span class="arithmatex">\(D\)</span> and <span class="arithmatex">\(T_0\)</span>.</p>
<figure>
<p><img alt="generate fit line excel" src="../static/least-squares/Excel%20Images/generate_fit_line_excel.PNG" /></p>
</figure>
<h3 id="calculate-chi2">Calculate <span class="arithmatex">\(\chi^{2}\)</span></h3>
<p>Find the difference between the experimental data and the generated fit line, squared (<span class="arithmatex">\(\chi^2\)</span>) and then sum this column. We will do our least squares minimisation on this sum through variation of the fit parameters <span class="arithmatex">\(\mathrm{log}_{10}(\tau_0)\)</span>, <span class="arithmatex">\(D\)</span> and <span class="arithmatex">\(T_0\)</span>. At this point it's a good idea to plot the experimental data and the fit line so that we have a graphical representation of whether the fit routine gives us a good solution:</p>
<figure>
<p><img alt="chi squared graph excel" src="../static/least-squares/Excel%20Images/chisqaured_graph_excel.PNG" /></p>
</figure>
<h3 id="load-the-solver">Load the 'Solver'</h3>
<p>Load the <strong>Excel</strong> Solver Add-in by clicking on the Data tab and selecting solver (should be on the very right hand side of the ribbon. If you can't see the `Solver' button then you need to enable it by following these <a href="https://support.microsoft.com/en-us/office/load-the-solver-add-in-in-excel-612926fc-d53b-46b4-872c-e24772f078ca">instructions</a>). </p>
<figure>
<p><img alt="excel solver" src="../static/least-squares/Excel%20Images/excel_solver.PNG" /></p>
</figure>
<ul>
<li>'Set Objective' should be the cell containing the sum of the <span class="arithmatex">\(\chi^2\)</span> column</li>
<li>'To' should be 'Min' (we want to minimise the sum of <span class="arithmatex">\(\chi^2\)</span> because <span class="arithmatex">\(\chi^2\)</span> is the difference between our experimental data and our fit line and so the smaller this difference, the better the fit). </li>
<li>'By Changing Variable Cells' should be set to our fit parameters (these will be changed in order to minimise the sum of <span class="arithmatex">\(\chi^2\)</span>).</li>
<li>'Make Unconstrained Variables Non-Negative' should be unticked in this case (since <span class="arithmatex">\(\mathrm{log}_{10}(\tau_0)\)</span> will probably be negative).</li>
<li>Click 'Solve'</li>
</ul>
<p>After the solver has finished, the 'Solver Results' window should appear. In the ideal case, the fit line should now go through the points and the fit parameter cells should contain the updated fit parameters. If you're happy this is the case, make sure 'Keep Solver Solution' is selected and click `OK' to keep the parameters.</p>
<figure>
<p><img alt="excel solver complete" src="../static/least-squares/Excel%20Images/solver_complete_excel.PNG" /></p>
</figure>
<h2 id="origin">Origin</h2>
<h3 id="data-manipulation">Data Manipulation</h3>
<p>First of all, load the data into <strong>Origin</strong>. At this stage we just need the <span class="arithmatex">\(T\)</span> values and the <span class="arithmatex">\(\tau_\alpha\)</span> data as they come out:</p>
<figure>
<p><img alt="origin load data" src="../static/least-squares/Origin%20Images/Loaddata-1.png" /></p>
</figure>
<p>Then, calculate the logarithm of the <span class="arithmatex">\(\tau_\alpha\)</span> values in a separate column:</p>
<figure>
<p><img alt="origin log data" src="../static/least-squares/Origin%20Images/log_data-1.png" /></p>
</figure>
<p>A plot of <span class="arithmatex">\(\mathrm{log}_{10}(\tau_\alpha)\)</span> vs <span class="arithmatex">\(T\)</span> will look like:</p>
<figure>
<p><img alt="origin plot initial" src="../static/least-squares/Origin%20Images/plot_initial-1.png" /></p>
</figure>
<h3 id="defining-a-new-fit-function">Defining a new fit function</h3>
<p>The data are clearly non-linear and so we'd like to fit them using a non-linear curve fitting routine. Click on 'Analysis' <span class="arithmatex">\(\rightarrow\)</span> 'Fitting' <span class="arithmatex">\(\rightarrow\)</span> 'Nonlinear Curve Fit':</p>
<figure>
<p><img alt="origin analysis fit menu" src="../static/least-squares/Origin%20Images/Analysis_fit_menu-1.png" /></p>
</figure>
<p>On the window that pops up ('NLfit()') click on the 'Category' dropdown and select 'New...'</p>
<figure>
<p><img alt="origin NL fit menu" src="../static/least-squares/Origin%20Images/NLfitmenu-1.png" /></p>
</figure>
<p>A popup window will ask you to name your new category of functions, so give it a name. Next, click on the dropdown next to 'function' and select `new' again...</p>
<figure>
<p><img alt="origin new function" src="../static/least-squares/Origin%20Images/new_function-1.png" /></p>
</figure>
<p>Name the function something and then click `Next'...</p>
<figure>
<p><img alt="origin new function name" src="../static/least-squares/Origin%20Images/new_function_name-1.png" /></p>
</figure>
<p>On the next screen you can set up the parameters. Here, <span class="arithmatex">\(T\)</span> is the independent variable, <span class="arithmatex">\(\tau\)</span> is the dependent variable and the equation has 3 free parameters, <span class="arithmatex">\(\tau_0\)</span>, <span class="arithmatex">\(D\)</span> and <span class="arithmatex">\(T_0\)</span>, which will be varied in the fitting routine. You can call these what you want, of course! It's worth mentioning again at this point that the values of <span class="arithmatex">\(\tau\)</span> and <span class="arithmatex">\(\tau_0\)</span> will be the 'logged' values but more on that in a sec... After all looks good, click 'Next'.</p>
<figure>
<p><img alt="orign param names" src="../static/least-squares/Origin%20Images/function_parameter_names-1.png" /></p>
</figure>
<p>In the next window, the first thing to set is the inital values for the varying parameters. By default, these are set to '1': if you try and fit without setting 'sensible' values here then the fit will not converge. A sensible region for <span class="arithmatex">\(\tau_0\)</span> is somewhere in the region of <span class="arithmatex">\(10^{-12}\)</span> to <span class="arithmatex">\(10^{-14}\)</span> and so, as we're dealing with the 'logged' value I have set the initial value of <span class="arithmatex">\(\tau_0\)</span> to -12. The <span class="arithmatex">\(D\)</span> parameter, also known as the 'strength' parameter, basically sets the rate at which the VFT equation tends to infinity and the temperature <span class="arithmatex">\(T_0\)</span> is the temperature at which this occurs. Setting <span class="arithmatex">\(D\)</span> to some integer value between 2 and 10 and <span class="arithmatex">\(T_0\)</span> to a `sensible' temperature is usually good enough. Here, I've set <span class="arithmatex">\(D\)</span> to 5 and <span class="arithmatex">\(T_0\)</span> to 100K (remember to work in Kelvin).</p>
<p>Once these initial parameter values have been set, you can enter the equation in the textbox below. Note that, because I've chosen to work in base 10 logarithm, I have to include a <span class="arithmatex">\(\mathrm{log}_{10}(e^{1})\)</span> term... Click on the 'quick check' button and make sure that it spits a result out. If all looks good, click `Next'.</p>
<figure>
<p><img alt="origin equation def" src="../static/least-squares/Origin%20Images/equation_def-1.png" /></p>
</figure>
<p>Just click `Next' through the next screen...</p>
<figure>
<p><img alt="origin init" src="../static/least-squares/Origin%20Images/init-1.png" /></p>
</figure>
<p>On the next screen you can set upper and lower bounds for the parameters. This isn't usually necessary for the VFT equation to work (if the initial parameter guesses aren't insane) so I've left these blank in this example... There are two more screens after this one that are not required for this exercise so now just click 'Finish' to get back to the NLFit() window.</p>
<figure>
<p><img alt="origin bounds" src="../static/least-squares/Origin%20Images/bounds-1.png" /></p>
</figure>
<h3 id="fit-the-data">Fit the data</h3>
<p>The NLfit() window will complain that you haven't selected any data, which, to be fair, we haven't. In order to select the data, click 'Data Selection' on the left hand side, press the 'plus' button next to 'Input Data' and click the arrow on the right hand side on the 'Range 1' line. Select the logged <span class="arithmatex">\(\tau_{\alpha}\)</span> data. If all goes well in this step there should be a graph on the bottom left with the data and a red fit line, which is just the VFT equation using the initial parameters. After this, click 'Fit' (optional: cross fingers).</p>
<figure>
<p><img alt="select data" src="../static/least-squares/Origin%20Images/select_data-1.png" /></p>
</figure>
<p>A popup will ask whether you want to 'see the report'. Click 'Yes' and something that looks like this, with the optimised parameters, their errors and a nice graph with a line through the points (hopefully): </p>
<figure>
<p><img alt="origin fit report" src="../static/least-squares/Origin%20Images/report-1.png" /></p>
</figure>
<p>The <span class="arithmatex">\(\alpha\)</span> relaxation timescales fitted with the VFT equation are usually plotted in an 'Arrhenius manner' i.e. against <span class="arithmatex">\(1000/T\)</span>. Luckily, the 'fit line' data is available by clicking the tab at the bottom of the 'Book' window and will be called something like 'FitNLCurve1'. You can then replot this data with your <span class="arithmatex">\(\tau_\alpha\)</span> data against <span class="arithmatex">\(1000/T\)</span> instead.</p>
<h2 id="matlab">Matlab</h2>
<p>Here I will describe a simple fit in <strong>Matlab</strong> using <code>lsqcurvefit</code> from the Curve Fitting Toolbox. One alternative to this would be to use <code>fminsearch</code> to minimise <span class="arithmatex">\(\sum{\chi^{2}}\)</span>.</p>
<h3 id="data-manipulation_1">Data Manipulation</h3>
<p>Firstly, let's put the <span class="arithmatex">\(T\)</span> and <span class="arithmatex">\(\tau_\alpha\)</span> data into vectors:</p>
<div class="language-Matlab highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">T</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mi">232</span><span class="p">;</span><span class="mi">230</span><span class="p">;</span><span class="mi">228</span><span class="p">;</span><span class="mi">226</span><span class="p">;</span><span class="mi">224</span><span class="p">;</span><span class="mi">222</span><span class="p">;</span><span class="mi">220</span><span class="p">;</span><span class="mi">218</span><span class="p">;</span><span class="mi">216</span><span class="p">;</span><span class="mi">214</span><span class="p">;</span><span class="mi">212</span><span class="p">;</span><span class="mi">210</span><span class="p">;</span><span class="mi">208</span><span class="p">;</span><span class="mi">206</span><span class="p">;</span><span class="mi">204</span><span class="p">;</span><span class="mi">202</span><span class="p">;</span><span class="mi">200</span><span class="p">];</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="n">tau_alpha</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mf">3.08000000000000e-06</span><span class="p">;</span><span class="mf">5.23000000000000e-06</span><span class="p">;</span><span class="mf">9.34000000000000e-06</span><span class="p">;</span><span class="k">...</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="mf">1.76000000000000e-05</span><span class="p">;</span><span class="mf">3.38000000000000e-05</span><span class="p">;</span><span class="mf">6.70000000000000e-05</span><span class="p">;</span><span class="mf">0.000141862000000000</span><span class="p">;</span><span class="k">...</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="mf">0.000313956000000000</span><span class="p">;</span><span class="mf">0.000740746000000000</span><span class="p">;</span><span class="mf">0.00186504500000000</span><span class="p">;</span><span class="k">...</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="mf">0.00518699100000000</span><span class="p">;</span><span class="mf">0.0156017730000000</span><span class="p">;</span><span class="mf">0.0495420140000000</span><span class="p">;</span><span class="mf">0.175158932000000</span><span class="p">;</span><span class="k">...</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="mf">0.658969937000000</span><span class="p">;</span><span class="mf">2.58630208200000</span><span class="p">;</span><span class="mf">10.7767433300000</span><span class="p">];</span>
</span></code></pre></div>
<h3 id="define-a-fit-function">Define a fit function</h3>
<p>There are a couple of different ways to define a function in <strong>Matlab</strong>: either in-line in the script you are using or as a separate file.</p>
<h4 id="in-line">In-Line</h4>
<p>To define a function 'in-line' in <strong>Matlab</strong> one can use an anonymous functions: </p>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="n">vft_function</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">@(</span><span class="n">p</span><span class="p">,</span><span class="n">T</span><span class="p">)</span><span class="w"> </span><span class="n">p</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="p">((</span><span class="nb">log10</span><span class="p">(</span><span class="nb">exp</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.*</span><span class="n">p</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.*</span><span class="n">p</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">./</span><span class="p">(</span><span class="n">T</span><span class="o">-</span><span class="n">p</span><span class="p">(</span><span class="mi">3</span><span class="p">)));</span>
</span></code></pre></div>
<p>Here, the input parameter 'p' is a vector containing the fit parameters (p(1) = <span class="arithmatex">\(\mathrm{log}_{10}(\tau_{0})\)</span>, p(2) = <span class="arithmatex">\(D\)</span> and p(3) = <span class="arithmatex">\(T_0\)</span>). Note the '.' before the multiplication and division symbols; these are used because <code>T</code> is a vector and not just a single value.</p>
<h4 id="separate-file">Separate File</h4>
<p>One can also define <code>vft_function</code> in a separate file. This function will return a set of <span class="arithmatex">\(\tau_\alpha\)</span> values for a given set of <span class="arithmatex">\(T\)</span> values and the fit parameters. The convention in <strong>Matlab</strong> is to name the function file after the function name i.e. <code>vft_function.m</code>.</p>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="k">function</span><span class="w"> </span>tau_alpha<span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nf">vft_function</span><span class="p">(</span>T,p<span class="p">)</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="w">    </span><span class="n">tau_alpha</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">p</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="p">((</span><span class="nb">log10</span><span class="p">(</span><span class="nb">exp</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.*</span><span class="n">p</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.*</span><span class="n">p</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">./</span><span class="p">(</span><span class="n">T</span><span class="o">-</span><span class="n">p</span><span class="p">(</span><span class="mi">3</span><span class="p">)));</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="k">end</span>
</span></code></pre></div>
<h3 id="fit-the-data_1">Fit the Data</h3>
<p>You can call the <code>lsqcurvefit</code> fitting routine (from the Curve Fitting Toolbox) in the following manner: </p>
<p><div class="language-matlab highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="n">pguess</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="o">-</span><span class="mi">12</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">150</span><span class="p">];</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="n">fit_params</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">lsqcurvefit</span><span class="p">(</span><span class="n">vft_function</span><span class="p">,</span><span class="n">pguess</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="nb">log10</span><span class="p">(</span><span class="n">tau</span><span class="p">));</span>
</span></code></pre></div>
The parameters given to <code>lsqcurvefit</code> are as follows: 1) the function (you will need an <code>@</code> symbol before the function name if you're calling it from an external .m file), 2) the initial guesses of the fit parameters (as a vector, in our case <code>pguess</code>), 3) x data to fit to (in this case <span class="arithmatex">\(T\)</span>), 4) y data to fit to (in this case <span class="arithmatex">\(\mathrm{log}_{10}(\tau_\alpha)\)</span>), </p>
<p>The output, <code>fit_params</code>, will be a vector containing the optimised parameters. We can now generate a <code>tau_alpha_fitted</code> vector based on these optimised parameters and plot both the experimental data and the fit to check that it has worked: </p>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="n">tau_alpha_fitted</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">vft_function</span><span class="p">(</span><span class="n">fit_params</span><span class="p">,</span><span class="n">T</span><span class="p">);</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="nb">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="nb">hold</span><span class="w"> </span><span class="n">off</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="nb">plot</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="nb">log10</span><span class="p">(</span><span class="n">tau_alpha</span><span class="p">),</span><span class="s">&#39;ro&#39;</span><span class="p">)</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="nb">hold</span><span class="w"> </span><span class="n">on</span>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="nb">plot</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">tau_alpha_fitted</span><span class="p">,</span><span class="s">&#39;k-&#39;</span><span class="p">)</span>
</span></code></pre></div>
<figure>
<p><img alt="vft fit in matlab" src="../static/least-squares/Matlab%20Images/VFT_fit_Matlab.svg" /></p>
</figure>
<h2 id="python">Python</h2>
<p>Here I will describe fitting data using the 'Curve Fit' module in the Scipy.Optimize package. Another useful alternative is the <a href="https://lmfit.github.io/lmfit-py/">'LMFit'</a> package.</p>
<h3 id="import-modules">Import modules</h3>
<p>First we need to import all the modules we will need. We will be using: 1) <code>scipy.optimize.curve_fit</code> to do the fitting, 2) <code>matplotlib.pyplot</code> to plot our results, and 3) <code>numpy</code> do to some maths.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">curve_fit</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span></code></pre></div>
<h3 id="data-manipulation_2">Data Manipulation</h3>
<p>Put our data into a couple of numpy arrays:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="n">T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">232</span><span class="p">,</span><span class="mi">230</span><span class="p">,</span><span class="mi">228</span><span class="p">,</span><span class="mi">226</span><span class="p">,</span><span class="mi">224</span><span class="p">,</span><span class="mi">222</span><span class="p">,</span><span class="mi">220</span><span class="p">,</span><span class="mi">218</span><span class="p">,</span><span class="mi">216</span><span class="p">,</span><span class="mi">214</span><span class="p">,</span><span class="mi">212</span><span class="p">,</span><span class="mi">210</span><span class="p">,</span><span class="mi">208</span><span class="p">,</span><span class="mi">206</span><span class="p">,</span><span class="mi">204</span><span class="p">,</span><span class="mi">202</span><span class="p">,</span><span class="mi">200</span><span class="p">])</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="n">tau_alpha</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">3.08000000000000e-06</span><span class="p">,</span><span class="mf">5.23000000000000e-06</span><span class="p">,</span><span class="mf">9.34000000000000e-06</span><span class="p">,</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="mf">1.76000000000000e-05</span><span class="p">,</span><span class="mf">3.38000000000000e-05</span><span class="p">,</span><span class="mf">6.70000000000000e-05</span><span class="p">,</span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="mf">0.000141862000000000</span><span class="p">,</span><span class="mf">0.000313956000000000</span><span class="p">,</span><span class="mf">0.000740746000000000</span><span class="p">,</span>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="mf">0.00186504500000000</span><span class="p">,</span><span class="mf">0.00518699100000000</span><span class="p">,</span><span class="mf">0.0156017730000000</span><span class="p">,</span>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="mf">0.0495420140000000</span><span class="p">,</span><span class="mf">0.175158932000000</span><span class="p">,</span><span class="mf">0.658969937000000</span><span class="p">,</span>
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="mf">2.58630208200000</span><span class="p">,</span><span class="mf">10.7767433300000</span><span class="p">])</span>
</span></code></pre></div>
<h3 id="define-fit-function">Define fit function</h3>
<p>Define the VFT function: </p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="k">def</span> <span class="nf">VFT_function</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">log10_tau_0</span><span class="p">,</span><span class="n">D</span><span class="p">,</span><span class="n">T_0</span><span class="p">):</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>    <span class="k">return</span> <span class="n">log10_tau_0</span><span class="o">+</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="n">D</span><span class="o">*</span><span class="n">T_0</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">T</span><span class="o">-</span><span class="n">T_0</span><span class="p">)</span>
</span></code></pre></div>
<h3 id="fit-the-data_2">Fit the data</h3>
<div class="language-python highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="n">pguess</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">12</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">150</span><span class="p">]</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="n">fit_params</span><span class="p">,</span><span class="n">covariance_matrix</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">VFT_function</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">tau_alpha</span><span class="p">),</span><span class="n">pguess</span><span class="p">)</span>
</span></code></pre></div>
<p>The parameters given to curve_fit are as follows: 1) the function, 2) x data (<span class="arithmatex">\(T\)</span>), 3) y data (<span class="arithmatex">\(\mathrm{log}_{10}(\tau_\alpha)\)</span>), 4) initial guesses for parameters. curve_fit returns 1) 'fit_params' which contains the optimised parameters and 'covariance_matrix' which contains the (ahem...) covariance matrix.</p>
<p>We can now generate a fitted set of <span class="arithmatex">\(\tau_\alpha\)</span> data based on the optimised parameters and plot both the experimental data and the fit to check that the fitting has worked.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="n">tau_alpha_fitted</span> <span class="o">=</span> <span class="n">VFT_function</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="o">*</span><span class="n">fit_params</span><span class="p">)</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">tau_alpha</span><span class="p">),</span><span class="s1">&#39;ro&#39;</span><span class="p">)</span>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">tau_alpha_fitted</span><span class="p">,</span><span class="s1">&#39;k-&#39;</span><span class="p">)</span>
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a>
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></code></pre></div>
<figure>
<p><img alt="fit in python" src="../static/least-squares/Python%20Images/fit_python.png" /></p>
</figure>
<h2 id="julia">Julia</h2>
<h3 id="load-modules">Load modules</h3>
<div class="language-julia highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="k">using</span><span class="w"> </span><span class="n">LsqFit</span><span class="p">,</span><span class="n">PyPlot</span>
</span></code></pre></div>
<h3 id="data-manipulation_3">Data Manipulation</h3>
<p>Now we can add our experimental data into a couple of vectors:</p>
<div class="language-julia highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="n">T</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">232</span><span class="p">,</span><span class="mi">230</span><span class="p">,</span><span class="mi">228</span><span class="p">,</span><span class="mi">226</span><span class="p">,</span><span class="mi">224</span><span class="p">,</span><span class="mi">222</span><span class="p">,</span><span class="mi">220</span><span class="p">,</span><span class="mi">218</span><span class="p">,</span><span class="mi">216</span><span class="p">,</span><span class="mi">214</span><span class="p">,</span><span class="mi">212</span><span class="p">,</span><span class="mi">210</span><span class="p">,</span><span class="mi">208</span><span class="p">,</span><span class="mi">206</span><span class="p">,</span><span class="mi">204</span><span class="p">,</span><span class="mi">202</span><span class="p">,</span><span class="mi">200</span><span class="p">];</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="n">tau_alpha</span><span class="w"> </span><span class="o">=</span><span class="p">[</span><span class="mf">3.08000000000000e-06</span><span class="p">,</span><span class="mf">5.23000000000000e-06</span><span class="p">,</span><span class="mf">9.34000000000000e-06</span><span class="p">,</span>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="mf">1.76000000000000e-05</span><span class="p">,</span><span class="mf">3.38000000000000e-05</span><span class="p">,</span><span class="mf">6.70000000000000e-05</span><span class="p">,</span>
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a><span class="mf">0.000141862000000000</span><span class="p">,</span><span class="mf">0.000313956000000000</span><span class="p">,</span><span class="mf">0.000740746000000000</span><span class="p">,</span>
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a><span class="mf">0.00186504500000000</span><span class="p">,</span><span class="mf">0.00518699100000000</span><span class="p">,</span><span class="mf">0.0156017730000000</span><span class="p">,</span>
</span><span id="__span-11-7"><a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a><span class="mf">0.0495420140000000</span><span class="p">,</span><span class="mf">0.175158932000000</span><span class="p">,</span><span class="mf">0.658969937000000</span><span class="p">,</span>
</span><span id="__span-11-8"><a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a><span class="mf">2.58630208200000</span><span class="p">,</span><span class="mf">10.7767433300000</span><span class="p">];</span>
</span></code></pre></div>
<h3 id="define-fit-function_1">Define fit function</h3>
<p>Julia allows for extremely simple function declarations in-line: </p>
<div class="language-julia highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="n">vft</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.+</span><span class="w"> </span><span class="p">(</span><span class="n">log10</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.*</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.*</span><span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">./</span><span class="p">(</span><span class="n">T</span><span class="o">.-</span><span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>
</span></code></pre></div>
<p>Note the '.' in front of all operators in the function so that we can input a vector for <span class="arithmatex">\(T\)</span>. </p>
<p>\subsection{Fit the data}</p>
<p>We will use the <code>curve_fit</code> function in the <code>LsqFit</code> module.</p>
<div class="language-julia highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="n">pguess</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="o">-</span><span class="mf">12.</span><span class="p">,</span><span class="w"> </span><span class="mf">10.</span><span class="p">,</span><span class="w"> </span><span class="mf">150.</span><span class="p">]</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="n">fit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">curve_fit</span><span class="p">(</span><span class="n">vft</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">log10</span><span class="o">.</span><span class="p">(</span><span class="n">tau_alpha</span><span class="p">),</span><span class="n">pguess</span><span class="p">)</span>
</span></code></pre></div>
<p>The parameters given to the 'curve_fit' are 1) the function, 2) x data (<span class="arithmatex">\(T\)</span>), 3) y data (<span class="arithmatex">\(\mathrm{log}_{10}(\tau_\alpha))\)</span>) and 4) the initial guesses for the fit parameters. The function returns a structure which we've sent to the variable 'fit'; the fit parameters can be access from 'fit.param'. Note that the 'pguess' parameters must have a decimal place after to ensure that Julia treats them as floats. </p>
<p>Finally, we can generate some fitted <span class="arithmatex">\(\tau_\alpha\)</span> data and plot the result. </p>
<div class="language-julia highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="n">fitted_tau_alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vft</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">fit</span><span class="o">.</span><span class="n">param</span><span class="p">)</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="n">fig</span><span class="p">,</span><span class="w"> </span><span class="n">ax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">subplots</span><span class="p">()</span>
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">log10</span><span class="o">.</span><span class="p">(</span><span class="n">tau_alpha</span><span class="p">),</span><span class="s">&quot;ro&quot;</span><span class="p">)</span>
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">fitted_tau_alpha</span><span class="p">,</span><span class="s">&quot;k-&quot;</span><span class="p">)</span>
</span><span id="__span-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a>
</span><span id="__span-14-7"><a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a><span class="n">display</span><span class="p">(</span><span class="n">gcf</span><span class="p">())</span>
</span></code></pre></div>
<figure>
<p><img alt="fit in julia" src="../static/least-squares/Julia%20Images/julia_fit.png" /></p>
</figure>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; Dan Baker 2023-present
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["content.code.copy", "toc.follow", "navigation.top"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.af256bd8.min.js"></script>
      
        <script src="../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>